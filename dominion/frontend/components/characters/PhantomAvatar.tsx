import React from 'react';

interface Props {
  size?: number;
  className?: string;
}

const PhantomAvatar: React.FC<Props> = ({ size = 128, className }) => {
  const p = size / 32;

  const pixels: [number, number, string][] = [
    // Hood
    [13,2,'#1f2937'],[14,2,'#1f2937'],[15,2,'#1f2937'],[16,2,'#1f2937'],[17,2,'#1f2937'],[18,2,'#1f2937'],
    [12,3,'#1f2937'],[13,3,'#111827'],[14,3,'#111827'],[15,3,'#111827'],[16,3,'#111827'],[17,3,'#111827'],[18,3,'#111827'],[19,3,'#1f2937'],
    [11,4,'#1f2937'],[12,4,'#111827'],[13,4,'#111827'],[14,4,'#111827'],[15,4,'#111827'],[16,4,'#111827'],[17,4,'#111827'],[18,4,'#111827'],[19,4,'#111827'],[20,4,'#1f2937'],

    // Face in shadow
    [11,5,'#1f2937'],[12,5,'#0a0a0a'],[13,5,'#0a0a0a'],[14,5,'#0a0a0a'],[15,5,'#0a0a0a'],[16,5,'#0a0a0a'],[17,5,'#0a0a0a'],[18,5,'#0a0a0a'],[19,5,'#0a0a0a'],[20,5,'#1f2937'],
    // Glowing green eyes
    [11,6,'#1f2937'],[12,6,'#0a0a0a'],[13,6,'#22c55e'],[14,6,'#0a0a0a'],[15,6,'#0a0a0a'],[16,6,'#0a0a0a'],[17,6,'#22c55e'],[18,6,'#0a0a0a'],[19,6,'#0a0a0a'],[20,6,'#1f2937'],
    [11,7,'#1f2937'],[12,7,'#0a0a0a'],[13,7,'#0a0a0a'],[14,7,'#0a0a0a'],[15,7,'#0a0a0a'],[16,7,'#0a0a0a'],[17,7,'#0a0a0a'],[18,7,'#0a0a0a'],[19,7,'#0a0a0a'],[20,7,'#1f2937'],
    [12,8,'#0a0a0a'],[13,8,'#0a0a0a'],[14,8,'#0a0a0a'],[15,8,'#16a34a'],[16,8,'#0a0a0a'],[17,8,'#0a0a0a'],[18,8,'#0a0a0a'],[19,8,'#0a0a0a'],

    // Neck
    [14,9,'#0a0a0a'],[15,9,'#0a0a0a'],[16,9,'#0a0a0a'],[17,9,'#0a0a0a'],

    // Shoulders - left normal, right mechanical
    [8,10,'#1f2937'],[9,10,'#1f2937'],[10,10,'#1f2937'],[11,10,'#1f2937'],[12,10,'#1f2937'],[13,10,'#1f2937'],[14,10,'#1f2937'],[15,10,'#1f2937'],[16,10,'#1f2937'],[17,10,'#1f2937'],[18,10,'#374151'],[19,10,'#4b5563'],[20,10,'#374151'],[21,10,'#4b5563'],[22,10,'#374151'],[23,10,'#4b5563'],

    // Torso - dark cloak left, mechanical arm right
    ...[11,12,13,14,15].flatMap(y => [
      [8,y,'#1f2937'],[9,y,'#111827'],[10,y,'#1f2937'],[11,y,'#111827'],[12,y,'#1f2937'],[13,y,'#111827'],[14,y,'#1f2937'],[15,y,'#111827'],[16,y,'#1f2937'],
      // Mechanical arm
      [21,y,'#4b5563'],[22,y,'#374151'],[23,y,'#4b5563'],
    ] as [number, number, string][]),

    // Green code lines on cloak
    [10,12,'#22c55e'],[11,13,'#22c55e'],[12,14,'#22c55e'],[10,15,'#22c55e'],
    [13,12,'#16a34a'],[14,13,'#16a34a'],[13,15,'#16a34a'],

    // Mechanical arm details - pistons, joints
    [20,11,'#6b7280'],[21,11,'#22c55e'],[22,11,'#4b5563'],[23,11,'#6b7280'],
    [20,12,'#4b5563'],[21,12,'#6b7280'],[22,12,'#22c55e'],[23,12,'#4b5563'],
    [20,13,'#6b7280'],[21,13,'#4b5563'],[22,13,'#6b7280'],[23,13,'#22c55e'],
    [20,14,'#4b5563'],[21,14,'#22c55e'],[22,14,'#4b5563'],[23,14,'#6b7280'],
    [20,15,'#22c55e'],[21,15,'#4b5563'],[22,15,'#6b7280'],[23,15,'#4b5563'],
    // Mechanical hand
    [23,16,'#6b7280'],[24,16,'#4b5563'],[25,16,'#6b7280'],
    [23,17,'#4b5563'],[24,17,'#22c55e'],[25,17,'#4b5563'],

    // Connecting body
    [17,11,'#1f2937'],[18,11,'#1f2937'],[19,11,'#374151'],
    [17,12,'#1f2937'],[18,12,'#374151'],[19,12,'#4b5563'],
    [17,13,'#1f2937'],[18,13,'#374151'],[19,13,'#4b5563'],
    [17,14,'#1f2937'],[18,14,'#374151'],[19,14,'#4b5563'],
    [17,15,'#1f2937'],[18,15,'#374151'],[19,15,'#4b5563'],

    // Lower body - fading into shadow
    ...[16,17,18,19,20,21].flatMap(y => {
      const w = Math.max(4, 16 - (y - 16) * 2);
      const start = 16 - Math.floor(w / 2);
      return Array.from({length: w}, (_, i) => [start + i, y, y % 2 === 0 ? '#1f2937' : '#111827'] as [number, number, string]);
    }),

    // Ghost trail / shadow wisps at bottom
    [12,22,'#1f2937'],[13,22,'#111827'],[14,22,'#1f2937'],[15,22,'#111827'],[16,22,'#1f2937'],[17,22,'#111827'],[18,22,'#1f2937'],[19,22,'#111827'],
    [13,23,'#111827'],[14,23,'#0a0a0a'],[15,23,'#111827'],[16,23,'#0a0a0a'],[17,23,'#111827'],[18,23,'#0a0a0a'],
    [14,24,'#0a0a0a'],[15,24,'#111827'],[16,24,'#0a0a0a'],[17,24,'#111827'],
    [11,24,'#0a0a0a'],[20,24,'#0a0a0a'],
    [10,25,'#111827'],[21,25,'#111827'],

    // Floating code fragments
    [5,8,'#22c55e'],[5,9,'#22c55e'],[6,9,'#22c55e'],
    [26,5,'#22c55e'],[27,5,'#22c55e'],[27,6,'#22c55e'],
    [4,14,'#16a34a'],[5,14,'#16a34a'],
    [26,12,'#16a34a'],[27,12,'#16a34a'],[27,13,'#16a34a'],
    [3,20,'#22c55e'],[28,18,'#22c55e'],
  ];

  return (
    <svg
      width={size}
      height={size}
      viewBox={`0 0 ${size} ${size}`}
      className={className}
      style={{ imageRendering: 'pixelated' }}
    >
      <defs>
        <filter id="phantom-glow">
          <feGaussianBlur stdDeviation="2" result="blur" />
          <feComposite in="SourceGraphic" in2="blur" operator="over" />
        </filter>
      </defs>
      {pixels.map(([x, y, color], i) => (
        <rect key={i} x={x * p} y={y * p} width={p} height={p} fill={color} />
      ))}
      {/* Glowing eyes */}
      {[[13,6],[17,6]].map(([ex, ey], i) => (
        <rect key={`eye-${i}`} x={ex * p} y={ey * p} width={p} height={p} fill="#22c55e" filter="url(#phantom-glow)">
          <animate attributeName="opacity" values="1;0.3;1" dur="2s" repeatCount="indefinite" />
        </rect>
      ))}
      {/* Code line scan effect */}
      <rect x={9 * p} y={0} width={p * 0.5} height={size} fill="#22c55e" opacity="0.15">
        <animate attributeName="y" values={`0;${size};0`} dur="3s" repeatCount="indefinite" />
      </rect>
    </svg>
  );
};

export default PhantomAvatar;
